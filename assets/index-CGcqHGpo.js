import{r as h,c as ee,g as Q,R as p,j as _,u as It,a as Ot}from"./index-Dk8Pe-UP.js";import{u as Oe}from"./config-provider-BAFojZN3.js";import{c as $t,u as Tt,a as Nt,w as G,b as U,d as se,e as jt,f as ue,g as Wt,h as _t,i as Dt,s as Rt,m as Z,S as Mt,j as ie,k as at,P as qt,r as ot,l as $e,t as ce,n as Yt,N as Pt,B as We,I as Ft}from"./index-DCm-Dobq.js";import{_ as Lt,a as st,d as j,u as At}from"./recordStore-B6hAhEJc.js";const Vt=$t(h.useEffect);var fe,_e;function it(){if(_e)return fe;_e=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return fe=n,fe}var de,De;function Gt(){if(De)return de;De=1;var n=typeof ee=="object"&&ee&&ee.Object===Object&&ee;return de=n,de}var me,Re;function lt(){if(Re)return me;Re=1;var n=Gt(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return me=t,me}var pe,Me;function Bt(){if(Me)return pe;Me=1;var n=lt(),e=function(){return n.Date.now()};return pe=e,pe}var ve,qe;function Ht(){if(qe)return ve;qe=1;var n=/\s/;function e(t){for(var s=t.length;s--&&n.test(t.charAt(s)););return s}return ve=e,ve}var ge,Ye;function zt(){if(Ye)return ge;Ye=1;var n=Ht(),e=/^\s+/;function t(s){return s&&s.slice(0,n(s)+1).replace(e,"")}return ge=t,ge}var he,Pe;function ut(){if(Pe)return he;Pe=1;var n=lt(),e=n.Symbol;return he=e,he}var ye,Fe;function Ut(){if(Fe)return ye;Fe=1;var n=ut(),e=Object.prototype,t=e.hasOwnProperty,s=e.toString,r=n?n.toStringTag:void 0;function o(a){var i=t.call(a,r),u=a[r];try{a[r]=void 0;var l=!0}catch{}var c=s.call(a);return l&&(i?a[r]=u:delete a[r]),c}return ye=o,ye}var be,Le;function Qt(){if(Le)return be;Le=1;var n=Object.prototype,e=n.toString;function t(s){return e.call(s)}return be=t,be}var ke,Ae;function Jt(){if(Ae)return ke;Ae=1;var n=ut(),e=Ut(),t=Qt(),s="[object Null]",r="[object Undefined]",o=n?n.toStringTag:void 0;function a(i){return i==null?i===void 0?r:s:o&&o in Object(i)?e(i):t(i)}return ke=a,ke}var Se,Ve;function Kt(){if(Ve)return Se;Ve=1;function n(e){return e!=null&&typeof e=="object"}return Se=n,Se}var xe,Ge;function Xt(){if(Ge)return xe;Ge=1;var n=Jt(),e=Kt(),t="[object Symbol]";function s(r){return typeof r=="symbol"||e(r)&&n(r)==t}return xe=s,xe}var we,Be;function Zt(){if(Be)return we;Be=1;var n=zt(),e=it(),t=Xt(),s=NaN,r=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt;function u(l){if(typeof l=="number")return l;if(t(l))return s;if(e(l)){var c=typeof l.valueOf=="function"?l.valueOf():l;l=e(c)?c+"":c}if(typeof l!="string")return l===0?l:+l;l=n(l);var v=o.test(l);return v||a.test(l)?i(l.slice(2),v?2:8):r.test(l)?s:+l}return we=u,we}var Ce,He;function en(){if(He)return Ce;He=1;var n=it(),e=Bt(),t=Zt(),s="Expected a function",r=Math.max,o=Math.min;function a(i,u,l){var c,v,f,m,b,E,k=0,d=!1,g=!1,S=!0;if(typeof i!="function")throw new TypeError(s);u=t(u)||0,n(l)&&(d=!!l.leading,g="maxWait"in l,f=g?r(t(l.maxWait)||0,u):f,S="trailing"in l?!!l.trailing:S);function y(w){var N=c,Y=v;return c=v=void 0,k=w,m=i.apply(Y,N),m}function x(w){return k=w,b=setTimeout(C,u),d?y(w):m}function R(w){var N=w-E,Y=w-k,J=u-N;return g?o(J,f-Y):J}function $(w){var N=w-E,Y=w-k;return E===void 0||N>=u||N<0||g&&Y>=f}function C(){var w=e();if($(w))return W(w);b=setTimeout(C,R(w))}function W(w){return b=void 0,S&&c?y(w):(c=v=void 0,m)}function T(){b!==void 0&&clearTimeout(b),k=0,c=E=v=b=void 0}function O(){return b===void 0?m:W(e())}function q(){var w=e(),N=$(w);if(c=arguments,v=this,E=w,N){if(b===void 0)return x(E);if(g)return clearTimeout(b),b=setTimeout(C,u),y(E)}return b===void 0&&(b=setTimeout(C,u)),m}return q.cancel=T,q.flush=O,q}return Ce=a,Ce}var tn=en();const nn=Q(tn);function rn(){var n=(typeof global>"u"?"undefined":typeof global)=="object"&&global&&global.Object===Object&&global,e=typeof self=="object"&&self&&self.Object===Object&&self;return n||e}rn()||(global.Date=Date);function an(n,e){var t,s=Tt(n),r=(t=e==null?void 0:e.wait)!==null&&t!==void 0?t:1e3,o=h.useMemo(function(){return nn(function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return s.current.apply(s,Lt([],st(a),!1))},r,e)},[]);return Nt(function(){o.cancel()}),{run:o,cancel:o.cancel,flush:o.flush}}function on(n,e,t){var s=st(h.useState({}),2),r=s[0],o=s[1],a=an(function(){o({})},t).run;h.useEffect(function(){return a()},e),Vt(n,[r])}var Ee,ze;function sn(){if(ze)return Ee;ze=1;var n=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",s=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function r(o,a){if(o===a)return!0;if(o&&a&&typeof o=="object"&&typeof a=="object"){if(o.constructor!==a.constructor)return!1;var i,u,l;if(Array.isArray(o)){if(i=o.length,i!=a.length)return!1;for(u=i;u--!==0;)if(!r(o[u],a[u]))return!1;return!0}var c;if(e&&o instanceof Map&&a instanceof Map){if(o.size!==a.size)return!1;for(c=o.entries();!(u=c.next()).done;)if(!a.has(u.value[0]))return!1;for(c=o.entries();!(u=c.next()).done;)if(!r(u.value[1],a.get(u.value[0])))return!1;return!0}if(t&&o instanceof Set&&a instanceof Set){if(o.size!==a.size)return!1;for(c=o.entries();!(u=c.next()).done;)if(!a.has(u.value[0]))return!1;return!0}if(s&&ArrayBuffer.isView(o)&&ArrayBuffer.isView(a)){if(i=o.length,i!=a.length)return!1;for(u=i;u--!==0;)if(o[u]!==a[u])return!1;return!0}if(o.constructor===RegExp)return o.source===a.source&&o.flags===a.flags;if(o.valueOf!==Object.prototype.valueOf&&typeof o.valueOf=="function"&&typeof a.valueOf=="function")return o.valueOf()===a.valueOf();if(o.toString!==Object.prototype.toString&&typeof o.toString=="function"&&typeof a.toString=="function")return o.toString()===a.toString();if(l=Object.keys(o),i=l.length,i!==Object.keys(a).length)return!1;for(u=i;u--!==0;)if(!Object.prototype.hasOwnProperty.call(a,l[u]))return!1;if(n&&o instanceof Element)return!1;for(u=i;u--!==0;)if(!((l[u]==="_owner"||l[u]==="__v"||l[u]==="__o")&&o.$$typeof)&&!r(o[l[u]],a[l[u]]))return!1;return!0}return o!==o&&a!==a}return Ee=function(a,i){try{return r(a,i)}catch(u){if((u.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw u}},Ee}var ln=sn();const un=Q(ln),Ue="adm-safe-area",cn=n=>G(n,p.createElement("div",{className:U(Ue,`${Ue}-position-${n.position}`)}));var ne={exports:{}},fn=ne.exports,Qe;function dn(){return Qe||(Qe=1,function(n,e){(function(t,s){n.exports=s()})(fn,function(){var t="day";return function(s,r,o){var a=function(l){return l.add(4-l.isoWeekday(),t)},i=r.prototype;i.isoWeekYear=function(){return a(this).year()},i.isoWeek=function(l){if(!this.$utils().u(l))return this.add(7*(l-this.isoWeek()),t);var c,v,f,m,b=a(this),E=(c=this.isoWeekYear(),v=this.$u,f=(v?o.utc:o)().year(c).startOf("year"),m=4-f.isoWeekday(),f.isoWeekday()>4&&(m+=7),f.add(m,t));return b.diff(E,"week")+1},i.isoWeekday=function(l){return this.$utils().u(l)?this.day()||7:this.day(this.day()%7?l:l-7)};var u=i.startOf;i.startOf=function(l,c){var v=this.$utils(),f=!!v.u(c)||c;return v.p(l)==="isoweek"?f?this.date(this.date()-(this.isoWeekday()-1)).startOf("day"):this.date(this.date()-1-(this.isoWeekday()-1)+7).endOf("day"):u.bind(this)(l,c)}}})}(ne)),ne.exports}var mn=dn();const ct=Q(mn);function Je(n,e,t){return n*e*t/(e+t*n)}function Ke(n,e,t,s,r=.15){return r===0?se(n,e,t):n<e?-Je(e-n,s,r)+e:n>t?+Je(n-t,s,r)+t:n}function pn(n){if(n==null||n==="")return 0;const e=n.trim();return e.endsWith("px")?parseFloat(e):e.endsWith("rem")?parseFloat(e)*parseFloat(window.getComputedStyle(document.documentElement).fontSize):e.endsWith("vw")?parseFloat(e)*window.innerWidth/100:0}const P="adm-picker-view",ft=h.memo(n=>{const{value:e,column:t,renderLabel:s}=n;function r(d){n.onSelect(d,n.index)}const[{y:o},a]=jt(()=>({from:{y:0},config:{tension:400,mass:.8}})),i=h.useRef(!1),u=h.useRef(null),l=h.useRef(null),c=h.useRef(34);ue(()=>{const d=l.current;d&&(c.current=pn(window.getComputedStyle(d).getPropertyValue("height")))}),ue(()=>{if(i.current||e===null)return;const d=t.findIndex(S=>S.value===e);if(d<0)return;const g=d*-c.current;a.start({y:g,immediate:o.goal!==g})},[e,t]),ue(()=>{if(t.length===0)e!==null&&r(null);else if(!t.some(d=>d.value===e)){const d=t[0];r(d.value)}},[t,e]);function v(d){const g=d*-c.current;a.start({y:g});const S=t[d];S&&r(S.value)}const f=d=>{const{direction:[,g],distance:[,S],velocity:[,y],offset:[,x],last:R}=d;return{direction:g,distance:S,velocity:y,offset:x,last:R}},m=d=>{i.current=!0;const g=-((t.length-1)*c.current),S=0,{direction:y,last:x,velocity:R,offset:$}=f(d);if(x){i.current=!1;const C=$+R*y*50,W=se(C,g,S),T=-Math.round(W/c.current);v(T)}else{const C=$;a.start({y:Ke(C,g,S,c.current*50,.2)})}},b=d=>{i.current=!0;const g=-((t.length-1)*c.current),S=0,{direction:y,last:x,velocity:R,distance:$}=f(d),C=-y,W=o.get();if(x){i.current=!1;const T=R*C*50,O=W+$*C+T,q=se(O,g,S),w=-Math.round(q/c.current);v(w)}else{const T=W+$*C;a.start({y:Ke(T,g,S,c.current*50,.2)})}};Wt(d=>{d.event.stopPropagation(),m(d)},{axis:"y",from:()=>[0,o.get()],filterTaps:!0,pointer:{touch:!0},target:u}),_t(d=>{d.event.stopPropagation(),b(d)},{target:n.mouseWheel?u:void 0,axis:"y",from:()=>[0,o.get()],preventDefault:!0,eventOptions:Rt?{passive:!1}:void 0});let E=null;function k(){if(E===null)return null;const d=t[E],g=E-1,S=E+1,y=t[g],x=t[S];return p.createElement("div",{className:`${P}-column-accessible`},p.createElement("div",{className:`${P}-column-accessible-current`,role:"button","aria-label":d?`当前选择的是：${d.label}`:"当前未选择"},"-"),p.createElement("div",{className:`${P}-column-accessible-button`,onClick:()=>{y&&v(g)},role:y?"button":"text","aria-label":y?`选择上一项：${y.label}`:"没有上一项"},"-"),p.createElement("div",{className:`${P}-column-accessible-button`,onClick:()=>{x&&v(S)},role:x?"button":"text","aria-label":x?`选择下一项：${x.label}`:"没有下一项"},"-"))}return p.createElement("div",{className:`${P}-column`},p.createElement("div",{className:`${P}-item-height-measure`,ref:l}),p.createElement(Dt.div,{ref:u,style:{translateY:o},className:`${P}-column-wheel`,"aria-hidden":!0},t.map((d,g)=>{var S;const y=n.value===d.value;y&&(E=g);function x(){i.current=!1,v(g)}return p.createElement("div",{key:(S=d.key)!==null&&S!==void 0?S:d.value,"data-selected":y,className:U(`${P}-column-item`,{[`${P}-column-item-active`]:y}),onClick:x,"aria-hidden":!y,"aria-label":y?"active":""},p.createElement("div",{className:`${P}-column-item-label`},s(d)))})),k())},(n,e)=>!(n.index!==e.index||n.value!==e.value||n.onSelect!==e.onSelect||n.renderLabel!==e.renderLabel||n.mouseWheel!==e.mouseWheel||!un(n.column,e.column)));ft.displayName="Wheel";function Xe(n){let e=null;return()=>(e===null&&(e=n()),e)}function dt(n,e){const t=Xe(()=>(typeof n=="function"?n(e):n).map(a=>a.map(i=>typeof i=="string"?{label:i,value:i}:i))),s=Xe(()=>e.map((o,a)=>{var i;const u=t()[a];return u&&(i=u.find(l=>l.value===o))!==null&&i!==void 0?i:null}));return{get columns(){return t()},get items(){return s()}}}function mt(n,e){return h.useMemo(()=>dt(n,e),[n,e])}const pt=n=>n.label,z="adm-picker-view",vn={defaultValue:[],renderLabel:pt,mouseWheel:!1,loadingContent:p.createElement("div",{className:`${z}-loading-content`},p.createElement(Mt,null))},vt=h.memo(n=>{const e=Z(vn,n),[t,s]=h.useState(e.value===void 0?e.defaultValue:e.value);h.useEffect(()=>{e.value!==void 0&&e.value!==t&&s(e.value)},[e.value]),h.useEffect(()=>{if(e.value===t)return;const i=window.setTimeout(()=>{e.value!==void 0&&e.value!==t&&s(e.value)},1e3);return()=>{window.clearTimeout(i)}},[e.value,t]);const r=mt(e.columns,t),o=r.columns;on(()=>{var i;e.value!==t&&((i=e.onChange)===null||i===void 0||i.call(e,t,r))},[t],{wait:0,leading:!1,trailing:!0});const a=h.useCallback((i,u)=>{s(l=>{const c=[...l];return c[u]=i,c})},[]);return G(e,p.createElement("div",{className:`${z}`},e.loading?e.loadingContent:p.createElement(p.Fragment,null,o.map((i,u)=>p.createElement(ft,{key:u,index:u,column:i,value:t[u],onSelect:a,renderLabel:e.renderLabel,mouseWheel:e.mouseWheel})),p.createElement("div",{className:`${z}-mask`},p.createElement("div",{className:`${z}-mask-top`}),p.createElement("div",{className:`${z}-mask-middle`}),p.createElement("div",{className:`${z}-mask-bottom`})))))});vt.displayName="PickerView";const L="adm-picker",gn={defaultValue:[],closeOnMaskClick:!0,renderLabel:pt,destroyOnClose:!1,forceRender:!1},Te=h.memo(h.forwardRef((n,e)=>{var t;const{locale:s}=Oe(),r=Z(gn,{confirmText:s.common.confirm,cancelText:s.common.cancel},n),[o,a]=ie({value:r.visible,defaultValue:!1,onChange:k=>{var d;k===!1&&((d=r.onClose)===null||d===void 0||d.call(r))}}),i={toggle:()=>{a(k=>!k)},open:()=>{a(!0)},close:()=>{a(!1)}};h.useImperativeHandle(e,()=>i);const[u,l]=ie(Object.assign(Object.assign({},r),{onChange:k=>{var d;const g=dt(r.columns,k);(d=r.onConfirm)===null||d===void 0||d.call(r,k,g)}})),c=mt(r.columns,u),[v,f]=h.useState(u);h.useEffect(()=>{v!==u&&f(u)},[o]),h.useEffect(()=>{o||f(u)},[u]);const m=at((k,d)=>{var g;f(k),o&&((g=r.onSelect)===null||g===void 0||g.call(r,k,d))}),b=G(r,p.createElement("div",{className:L},p.createElement("div",{className:`${L}-header`},p.createElement("a",{role:"button",className:`${L}-header-button`,onClick:()=>{var k;(k=r.onCancel)===null||k===void 0||k.call(r),a(!1)}},r.cancelText),p.createElement("div",{className:`${L}-header-title`},r.title),p.createElement("a",{role:"button",className:U(`${L}-header-button`,r.loading&&`${L}-header-button-disabled`),onClick:()=>{r.loading||(l(v,!0),a(!1))},"aria-disabled":r.loading},r.confirmText)),p.createElement("div",{className:`${L}-body`},p.createElement(vt,{loading:r.loading,loadingContent:r.loadingContent,columns:r.columns,renderLabel:r.renderLabel,value:v,mouseWheel:r.mouseWheel,onChange:m})))),E=p.createElement(qt,{style:r.popupStyle,className:U(`${L}-popup`,r.popupClassName),visible:o,position:"bottom",onMaskClick:()=>{var k;r.closeOnMaskClick&&((k=r.onCancel)===null||k===void 0||k.call(r),a(!1))},getContainer:r.getContainer,destroyOnClose:r.destroyOnClose,afterShow:r.afterShow,afterClose:r.afterClose,onClick:r.onClick,forceRender:r.forceRender,stopPropagation:r.stopPropagation},b,p.createElement(cn,{position:"bottom"}));return p.createElement(p.Fragment,null,E,(t=r.children)===null||t===void 0?void 0:t.call(r,c.items,i))}));Te.displayName="Picker";function hn(n){return new Promise(e=>{const t=()=>{const[r,o]=h.useState(!1);return h.useEffect(()=>{o(!0)},[]),p.createElement(Te,Object.assign({},n,{visible:r,onConfirm:(a,i)=>{var u;(u=n.onConfirm)===null||u===void 0||u.call(n,a,i),e(a)},onClose:()=>{var a;(a=n.onClose)===null||a===void 0||a.call(n),o(!1),e(null)},afterClose:()=>{var a;(a=n.afterClose)===null||a===void 0||a.call(n),s()}}))},s=ot(p.createElement(t,null))})}const yn=$e(Te,{prompt:hn}),bn=(n={})=>h.useMemo(()=>{const{label:t="label",value:s="value",disabled:r="disabled",children:o="children"}=n;return[t,s,o,r]},[JSON.stringify(n)]);var re={exports:{}},kn=re.exports,Ze;function Sn(){return Ze||(Ze=1,function(n,e){(function(t,s){n.exports=s()})(kn,function(){return function(t,s){s.prototype.isoWeeksInYear=function(){var r=this.isLeapYear(),o=this.endOf("y").day();return o===4||r&&o===5?53:52}}})}(re)),re.exports}var xn=Sn();const gt=Q(xn);var ae={exports:{}},wn=ae.exports,et;function Cn(){return et||(et=1,function(n,e){(function(t,s){n.exports=s()})(wn,function(){return function(t,s){s.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})}(ae)),ae.exports}var En=Cn();const ht=Q(En),X="TILL_NOW";j.extend(ct);j.extend(gt);j.extend(ht);const A={year:0,month:1,day:2,hour:3,minute:4,second:5};function In(n,e,t,s,r,o,a){const i=[],u=e.getFullYear(),l=e.getMonth()+1,c=e.getDate(),v=e.getHours(),f=e.getMinutes(),m=e.getSeconds(),b=t.getFullYear(),E=t.getMonth()+1,k=t.getDate(),d=t.getHours(),g=t.getMinutes(),S=t.getSeconds(),y=A[s],x=parseInt(n[0]),R=j(Ie([n[0],n[1],"1"])),$=parseInt(n[1]),C=parseInt(n[2]),W=parseInt(n[3]),T=parseInt(n[4]),O=x===u,q=x===b,w=O&&$===l,N=q&&$===E,Y=w&&C===c,J=N&&C===k,Ne=Y&&W===v,je=J&&W===d,xt=Ne&&T===f,wt=je&&T===g,B=(M,F,D)=>{let I=[];for(let H=M;H<=F;H++)I.push(H);const Ct=n.slice(0,A[D]),le=o==null?void 0:o[D];return le&&typeof le=="function"&&(I=I.filter(H=>le(H,{get date(){const Et=[...Ct,H.toString()];return Ie(Et)}}))),I};if(y>=A.year){const D=B(u,b,"year");i.push(D.map(I=>({label:r("year",I),value:I.toString()})))}if(y>=A.month){const D=B(O?l:1,q?E:12,"month");i.push(D.map(I=>({label:r("month",I),value:I.toString()})))}if(y>=A.day){const M=w?c:1,F=N?k:R.daysInMonth(),D=B(M,F,"day");i.push(D.map(I=>({label:r("day",I),value:I.toString()})))}if(y>=A.hour){const D=B(Y?v:0,J?d:23,"hour");i.push(D.map(I=>({label:r("hour",I),value:I.toString()})))}if(y>=A.minute){const D=B(Ne?f:0,je?g:59,"minute");i.push(D.map(I=>({label:r("minute",I),value:I.toString()})))}if(y>=A.second){const D=B(xt?m:0,wt?S:59,"second");i.push(D.map(I=>({label:r("second",I),value:I.toString()})))}if(a&&(i[0].push({label:r("now",null),value:X}),X===(n==null?void 0:n[0])))for(let M=1;M<i.length;M+=1)i[M]=[];return i}function On(n){return n?[n.getFullYear().toString(),(n.getMonth()+1).toString(),n.getDate().toString(),n.getHours().toString(),n.getMinutes().toString(),n.getSeconds().toString()]:[]}function Ie(n){var e,t,s,r,o,a;const i=(e=n[0])!==null&&e!==void 0?e:"1900",u=(t=n[1])!==null&&t!==void 0?t:"1",l=(s=n[2])!==null&&s!==void 0?s:"1",c=(r=n[3])!==null&&r!==void 0?r:"0",v=(o=n[4])!==null&&o!==void 0?o:"0",f=(a=n[5])!==null&&a!==void 0?a:"0";return new Date(parseInt(i),parseInt(u)-1,parseInt(l),parseInt(c),parseInt(v),parseInt(f))}var oe={exports:{}},$n=oe.exports,tt;function Tn(){return tt||(tt=1,function(n,e){(function(t,s){n.exports=s()})($n,function(){var t="month",s="quarter";return function(r,o){var a=o.prototype;a.quarter=function(l){return this.$utils().u(l)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(l-1))};var i=a.add;a.add=function(l,c){return l=Number(l),this.$utils().p(c)===s?this.add(3*l,t):i.bind(this)(l,c)};var u=a.startOf;a.startOf=function(l,c){var v=this.$utils(),f=!!v.u(c)||c;if(v.p(l)===s){var m=this.quarter()-1;return f?this.month(3*m).startOf(t).startOf("day"):this.month(3*m+2).endOf(t).endOf("day")}return u.bind(this)(l,c)}}})}(oe)),oe.exports}var Nn=Tn();const jn=Q(Nn);j.extend(jn);const te={year:0,quarter:1};function Wn(n,e,t,s,r,o){const a=[],i=e.getFullYear(),u=t.getFullYear(),l=te[s],c=parseInt(n[0]),v=c===i,f=c===u,m=j(e),b=j(t),E=m.quarter(),k=b.quarter(),d=(g,S,y)=>{let x=[];for(let C=g;C<=S;C++)x.push(C);const R=n.slice(0,te[y]),$=o==null?void 0:o[y];return $&&typeof $=="function"&&(x=x.filter(C=>$(C,{get date(){const W=[...R,C.toString()];return yt(W)}}))),x};if(l>=te.year){const y=d(i,u,"year");a.push(y.map(x=>({label:r("year",x),value:x.toString()})))}if(l>=te.quarter){const y=d(v?E:1,f?k:4,"quarter");a.push(y.map(x=>({label:r("quarter",x),value:x.toString()})))}return a}function _n(n){if(!n)return[];const e=j(n);return[e.year().toString(),e.quarter().toString()]}function yt(n){var e,t;const s=(e=n[0])!==null&&e!==void 0?e:"1900",r=(t=n[1])!==null&&t!==void 0?t:"1";return j().year(parseInt(s)).quarter(parseInt(r)).hour(0).minute(0).second(0).toDate()}j.extend(ct);j.extend(gt);j.extend(ht);const K={year:0,week:1,"week-day":2};function Dn(n,e,t,s,r,o){const a=[],i=e.getFullYear(),u=t.getFullYear(),l=K[s],c=parseInt(n[0]),v=c===i,f=c===u,m=j(e),b=j(t),E=m.isoWeek(),k=b.isoWeek(),d=m.isoWeekday(),g=b.isoWeekday(),S=parseInt(n[1]),y=v&&S===E,x=f&&S===k,R=j(`${c}-01-01`).isoWeeksInYear(),$=(C,W,T)=>{let O=[];for(let N=C;N<=W;N++)O.push(N);const q=n.slice(0,K[T]),w=o==null?void 0:o[T];return w&&typeof w=="function"&&(O=O.filter(N=>w(N,{get date(){const Y=[...q,N.toString()];return bt(Y)}}))),O};if(l>=K.year){const T=$(i,u,"year");a.push(T.map(O=>({label:r("year",O),value:O.toString()})))}if(l>=K.week){const T=$(v?E:1,f?k:R,"week");a.push(T.map(O=>({label:r("week",O),value:O.toString()})))}if(l>=K["week-day"]){const T=$(y?d:1,x?g:7,"week-day");a.push(T.map(O=>({label:r("week-day",O),value:O.toString()})))}return a}function Rn(n){if(!n)return[];const e=j(n);return[e.isoWeekYear().toString(),e.isoWeek().toString(),e.isoWeekday().toString()]}function bt(n){var e,t,s;const r=(e=n[0])!==null&&e!==void 0?e:"1900",o=(t=n[1])!==null&&t!==void 0?t:"1",a=(s=n[2])!==null&&s!==void 0?s:"1";return j(`${parseInt(r)}-01-01`).isoWeek(parseInt(o)).isoWeekday(parseInt(a)).hour(0).minute(0).second(0).toDate()}const Mn={year:1,month:2,day:3,hour:4,minute:5,second:6},qn=(n,e)=>{if(e.includes("week"))return Rn(n);if(e.includes("quarter"))return _n(n);{const t=e;return On(n).slice(0,Mn[t])}},nt=(n,e)=>{if((n==null?void 0:n[0])===X){const t=new Date;return t.tillNow=!0,t}return e.includes("week")?bt(n):e.includes("quarter")?yt(n):Ie(n)},Yn=(n,e,t,s,r,o,a)=>s.startsWith("week")?Dn(n,e,t,s,r,o):s.startsWith("quarter")?Wn(n,e,t,s,r,o):In(n,e,t,s,r,o,a);function Pn(n){const{locale:e}=Oe();return h.useCallback((t,s)=>{if(n)return n(t,s);switch(t){case"minute":case"second":case"hour":return("0"+s.toString()).slice(-2);case"now":return e.DatePicker.tillNow;default:return s.toString()}},[n])}const rt=new Date().getFullYear(),Fn={min:new Date(new Date().setFullYear(rt-10)),max:new Date(new Date().setFullYear(rt+10)),precision:"day",defaultValue:null},kt=h.forwardRef((n,e)=>{const t=Z(Fn,n),{renderLabel:s}=t,[r,o]=ie({value:t.value,defaultValue:t.defaultValue,onChange:f=>{var m;f!==null&&((m=t.onConfirm)===null||m===void 0||m.call(t,f))}}),a=h.useMemo(()=>new Date,[]),i=Pn(s),u=h.useMemo(()=>{let f=r??a;return f.tillNow?[X]:(f=new Date(se(f.getTime(),t.min.getTime(),t.max.getTime())),qn(f,t.precision))},[r,t.precision,t.min,t.max]),l=h.useCallback(f=>{const m=nt(f,t.precision);o(m,!0)},[o,t.precision]),c=at(f=>{var m;const b=nt(f,t.precision);(m=t.onSelect)===null||m===void 0||m.call(t,b)}),v=h.useCallback(f=>Yn(f,t.min,t.max,t.precision,i,t.filter,t.tillNow),[t.min,t.max,t.precision,i,t.tillNow]);return G(t,p.createElement(yn,{ref:e,columns:v,value:u,onCancel:t.onCancel,onClose:t.onClose,closeOnMaskClick:t.closeOnMaskClick,visible:t.visible,confirmText:t.confirmText,cancelText:t.cancelText,onConfirm:l,onSelect:c,getContainer:t.getContainer,loading:t.loading,loadingContent:t.loadingContent,afterShow:t.afterShow,afterClose:t.afterClose,onClick:t.onClick,title:t.title,stopPropagation:t.stopPropagation,mouseWheel:t.mouseWheel,destroyOnClose:t.destroyOnClose,forceRender:t.forceRender},(f,m)=>{var b;return(b=t.children)===null||b===void 0?void 0:b.call(t,r,m)}))});function Ln(n){return new Promise(e=>{const t=()=>{const[r,o]=h.useState(!1);return h.useEffect(()=>{o(!0)},[]),p.createElement(kt,Object.assign({},n,{visible:r,onConfirm:a=>{var i;(i=n.onConfirm)===null||i===void 0||i.call(n,a),e(a)},onClose:()=>{var a;(a=n.onClose)===null||a===void 0||a.call(n),o(!1),e(null)},afterClose:()=>{var a;(a=n.afterClose)===null||a===void 0||a.call(n),s()}}))},s=ot(p.createElement(t,null))})}const An=$e(kt,{prompt:Ln,DATE_NOW:X}),St="adm-grid",Vn=n=>{const e={"--columns":n.columns.toString()},{gap:t}=n;return t!==void 0&&(Array.isArray(t)?(e["--gap-horizontal"]=ce(t[0]),e["--gap-vertical"]=ce(t[1])):e["--gap"]=ce(t)),G(n,p.createElement("div",{className:St,style:e},n.children))},Gn=n=>{const e=Z({span:1},n),t={"--item-span":e.span};return G(e,p.createElement("div",{className:`${St}-item`,style:t,onClick:e.onClick},e.children))},Bn=$e(Vn,{Item:Gn}),Hn=h.memo(()=>p.createElement("svg",{width:"17px",height:"13px",viewBox:"0 0 17 13",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},p.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round"},p.createElement("g",{transform:"translate(-2832.000000, -1103.000000)",stroke:"#FFFFFF",strokeWidth:"3"},p.createElement("g",{transform:"translate(2610.000000, 955.000000)"},p.createElement("g",{transform:"translate(24.000000, 91.000000)"},p.createElement("g",{transform:"translate(179.177408, 36.687816)"},p.createElement("polyline",{points:"34.2767388 22 24.797043 31.4796958 21 27.6826527"})))))))),V="adm-selector",zn={multiple:!1,defaultValue:[],showCheckMark:!0},Un=n=>{const e=Z(zn,n),[t,s,,r]=bn(e.fieldNames),[o,a]=ie({value:e.value,defaultValue:e.defaultValue,onChange:l=>{var c;const v={get items(){return e.options.filter(f=>l.includes(f[s]))}};(c=e.onChange)===null||c===void 0||c.call(e,l,v)}}),{locale:i}=Oe(),u=e.options.map(l=>{const c=(o||[]).includes(l[s]),v=l[r]||e.disabled,f=U(`${V}-item`,{[`${V}-item-active`]:c&&!e.multiple,[`${V}-item-multiple-active`]:c&&e.multiple,[`${V}-item-disabled`]:v});return p.createElement("div",{key:l[s],className:f,onClick:()=>{if(!v)if(e.multiple){const m=c?o.filter(b=>b!==l[s]):[...o,l[s]];a(m)}else{const m=c?[]:[l[s]];a(m)}},role:"option","aria-selected":c&&!e.multiple||c&&e.multiple},l[t],l.description&&p.createElement("div",{className:`${V}-item-description`},l.description),c&&e.showCheckMark&&p.createElement("div",{className:`${V}-check-mark-wrapper`},p.createElement(Hn,null)))});return G(e,p.createElement("div",{className:V,role:"listbox","aria-label":i.Selector.name},e.columns?p.createElement(Bn,{columns:e.columns},u):p.createElement(Yt,{wrap:!0},u)))},Qn=({onChange:n,defaultValue:e})=>{const[t,s]=h.useState(new Date(Date.now())),[r,o]=h.useState(!1);h.useEffect(()=>{e&&s(new Date(e))},[e]);const a={year:"年",month:"月",day:"日",hour:"时"};return _.jsxs("div",{className:"calendar-picker",children:[_.jsx("p",{className:"calendar-display",onClick:()=>{o(!0)},children:j(t).format("YYYY.MM.DD - HH:00")}),_.jsx(An,{visible:r,value:t,onClose:()=>{o(!1)},onConfirm:i=>{s(i),o(!1),n(i)},precision:"hour",renderLabel:(i,u)=>`${u}${a[i]}`})]})},er=()=>{const n=It(),e=Ot(),[t,s]=h.useState({id:0,type:"charging",oil:0,electric:0,cost:0,kilometerOfDisplay:0,date:Date.now()}),{setRecordData:r,removeRecordById:o,updateRecordById:a,recordList:i}=At();h.useEffect(()=>{if(e.id){const f=i.find(m=>Number(m.id)===Number(e.id));f&&s(f)}},[e.id]);const u=(f,m)=>{s({...t,[f.key]:m})},l=()=>{e.id&&(o(e.id),n(-1))},c=()=>{e.id?a(Number(e.id),t):r(t),n(-1)},v=[{key:"type",label:"类型：",value:t.type,dataType:"select",data:{options:[{label:"加油",value:"refueling"},{label:"充电",value:"charging"}]}},t.type==="refueling"&&{key:"oil",label:"油量：",value:t.oil,dataType:"number",unit:"升"},t.type==="charging"&&{key:"electric",label:"电量：",value:t.electric,dataType:"number",unit:"度"},{key:"cost",label:"费用：",value:t.cost,dataType:"number",unit:"元（CNY）"},{key:"kilometerOfDisplay",label:"表显里程：",value:t.kilometerOfDisplay,dataType:"number",unit:"Km"},{key:"date",label:"时间",value:t.date,dataType:"date"}].filter(f=>!!f);return _.jsxs("div",{className:"record-container",children:[_.jsx(Pt,{title:e.id?"编辑记录":"新增记录",right:e.id&&_.jsx(We,{fill:"none",onClick:l,style:{color:"#ff4d4f"},children:"删除"})}),_.jsx("div",{className:U("type-line",t.type)}),_.jsxs("div",{className:"record-content",children:[_.jsx("div",{className:"record-form",children:v.map(f=>_.jsxs("div",{className:"record-form-item",children:[_.jsx("div",{className:"record-form-item-label",children:f.label}),_.jsxs("div",{className:"record-form-item-input",children:[f.dataType==="select"?_.jsx(Un,{options:f.data.options,value:[f.value],onChange:m=>{u(f,m[0])}}):null,f.dataType==="number"?_.jsx(Ft,{onClick:m=>{m.target.select()},type:"number",value:String(f.value),onChange:m=>{u(f,m)}}):null,f.dataType==="date"?_.jsx(Qn,{onChange:m=>{u(f,m.toString())},defaultValue:new Date(f.value)}):null,_.jsx("p",{className:"record-form-item-unit",children:f.unit})]})]},f.key))}),_.jsx(We,{type:"submit",color:"primary",className:"record-form-submit",onClick:c,children:"提交"})]})]})};export{er as default};
